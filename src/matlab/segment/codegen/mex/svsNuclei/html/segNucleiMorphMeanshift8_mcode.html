<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,108">108</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,109">109</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,110">110</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S41T22U312">f</span>,<span class="var type1" id="S42T23U313">L</span>] = segNucleiMorphMeanshift(<span class="var type1" id="S43T1U316">color_img</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,111">111</a></span><span class="line">    <span class="var type2" id="S41T0U319">f</span> = [];</span></span>
<span class="srcline"><span class="lineno"><a href="1,112">112</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,113">113</a></span><span class="line">    <span class="var type1" id="S44T10U324">r</span> = <span class="var type1" id="S43T1U326">color_img</span>( :, :, 1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,114">114</a></span><span class="line">    <span class="var type1" id="S45T10U332">g</span> = <span class="var type1" id="S43T1U334">color_img</span>( :, :, 2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,115">115</a></span><span class="line">    <span class="var type0" id="S46T0U340">b</span> = <span class="var type1" id="S43T1U342">color_img</span>( :, :, 3);</span></span>
<span class="srcline"><span class="lineno"><a href="1,116">116</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,117">117</a></span><span class="line">    <span class="comment">%T1=2.5; T2=2;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118">118</a></span><span class="line">    <span class="var type1" id="S47T6U348">T1</span>=5; <span class="var type1" id="S48T6U352">T2</span>=4;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119">119</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,120">120</a></span><span class="line">    <span class="var type1" id="S49T6U356">imR2G</span> = double(<span class="var type1" id="S44T10U360">r</span>)./(double(<span class="var type1" id="S45T10U365">g</span>)+eps);</span></span>
<span class="srcline"><span class="lineno"><a href="1,121">121</a></span><span class="line">    <span class="var type1" id="S52T4U370">bw1</span> = <span class="var type1" id="S49T6U372">imR2G</span> &gt; <span class="var type1" id="S47T6U373">T1</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122">122</a></span><span class="line">    <span class="var type1" id="S53T4U376">bw2</span> = <span class="var type1" id="S49T6U378">imR2G</span> &gt; <span class="var type1" id="S48T6U379">T2</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123">123</a></span><span class="line">    <span class="var type1" id="S54T7U382">ind</span> = find(<span class="var type1" id="S52T4U385">bw1</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,124">124</a></span><span class="line">    <span class="keyword">if</span> ~isempty(<span class="var type1" id="S54T7U391">ind</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,125">125</a></span><span class="line">        [<span class="var type1" id="S57T7U395">rows</span>, <span class="var type1" id="S58T7U396">cols</span>]=ind2sub(size(<span class="var type1" id="S49T6U401">imR2G</span>),<span class="var type1" id="S54T7U402">ind</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,126">126</a></span><span class="line">        <span class="var type0" id="S61T0U405">rbc</span> = <span class="message fatal" id="M2F8C">bwselect</span>(<span class="var type1" id="S53T4U409">bw2</span>,<span class="var type1" id="S58T7U410">cols</span>,<span class="var type1" id="S57T7U411">rows</span>,8) &amp; (double(<span class="var type2" id="S44T0U418">r</span>)./(double(<span class="var type0" id="S46T0U423">b</span>)+eps)&gt;1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,127">127</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128">128</a></span><span class="line">        <span class="var type0" id="S61T0U430">rbc</span> = zeros(size(<span class="var type2" id="S49T0U435">imR2G</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,129">129</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130">130</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,131">131</a></span><span class="line">    <span class="var type0" id="S64T0U438">rc</span> = 255 - <span class="var type2" id="S44T0U441">r</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132">132</a></span><span class="line">    <span class="var type0" id="S65T0U444">rc_open</span> = imopen(<span class="var type0" id="S64T0U447">rc</span>, strel(<span class="string">'disk'</span>,10));</span></span>
<span class="srcline"><span class="lineno"><a href="1,133">133</a></span><span class="line">    <span class="var type0" id="S68T0U454">rc_recon</span> = imreconstruct(<span class="var type0" id="S65T0U457">rc_open</span>,<span class="var type0" id="S64T0U458">rc</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,134">134</a></span><span class="line">    <span class="var type0" id="S70T0U461">diffIm</span> = <span class="var type0" id="S64T0U463">rc</span>-<span class="var type0" id="S68T0U464">rc_recon</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135">135</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,136">136</a></span><span class="line">    <span class="var type0" id="S71T0U467">G1</span>=80; <span class="var type0" id="S72T0U471">G2</span>=45; <span class="comment">% default settings</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137">137</a></span><span class="line">    <span class="comment">%G1=80; G2=30;  % 2nd run</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138">138</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,139">139</a></span><span class="line">    <span class="var type2" id="S52T0U475">bw1</span> = imfill(<span class="var type0" id="S70T0U479">diffIm</span>&gt;<span class="var type0" id="S71T0U480">G1</span>,<span class="string">'holes'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,140">140</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,141">141</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142">142</a></span><span class="line">    [<span class="var type2" id="S42T0U485">L</span>] = bwlabel(<span class="var type2" id="S52T0U488">bw1</span>, 8);</span></span>
<span class="srcline"><span class="lineno"><a href="1,143">143</a></span><span class="line">    <span class="var type0" id="S75T0U492">stats</span> = regionprops(<span class="var type2" id="S42T0U495">L</span>, <span class="string">'Area'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,144">144</a></span><span class="line">    <span class="var type0" id="S77T0U499">areas</span> = [<span class="var type0" id="S75T0U503">stats</span>.Area];</span></span>
<span class="srcline"><span class="lineno"><a href="1,145">145</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,146">146</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147">147</a></span><span class="line">    <span class="var type2" id="S54T0U507">ind</span> = find(<span class="var type0" id="S77T0U512">areas</span>&gt;10 &amp; <span class="var type0" id="S77T0U515">areas</span>&lt;1000);</span></span>
<span class="srcline"><span class="lineno"><a href="1,148">148</a></span><span class="line">    <span class="var type2" id="S52T0U519">bw1</span> = ismember(<span class="var type2" id="S42T0U522">L</span>,<span class="var type2" id="S54T0U523">ind</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,149">149</a></span><span class="line">    <span class="var type2" id="S53T0U526">bw2</span> = <span class="var type0" id="S70T0U528">diffIm</span>&gt;<span class="var type0" id="S72T0U529">G2</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150">150</a></span><span class="line">    <span class="var type2" id="S54T0U532">ind</span> = find(<span class="var type2" id="S52T0U535">bw1</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,151">151</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,152">152</a></span><span class="line">    <span class="keyword">if</span> isempty(<span class="var type2" id="S54T0U540">ind</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,153">153</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154">154</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,156">156</a></span><span class="line">    [<span class="var type2" id="S57T0U545">rows</span>,<span class="var type2" id="S58T0U546">cols</span>] = ind2sub(size(<span class="var type0" id="S70T0U551">diffIm</span>),<span class="var type2" id="S54T0U552">ind</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,157">157</a></span><span class="line">    <span class="var type0" id="S79T0U555">seg_norbc</span> = bwselect(<span class="var type2" id="S53T0U559">bw2</span>,<span class="var type2" id="S58T0U560">cols</span>,<span class="var type2" id="S57T0U561">rows</span>,8) &amp; ~<span class="var type0" id="S61T0U564">rbc</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158">158</a></span><span class="line">    <span class="var type0" id="S80T0U567">seg_nohole</span> = imfill(<span class="var type0" id="S79T0U570">seg_norbc</span>,<span class="string">'holes'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,159">159</a></span><span class="line">    <span class="var type0" id="S81T0U574">seg_open</span> = imopen(<span class="var type0" id="S80T0U577">seg_nohole</span>,strel(<span class="string">'disk'</span>,1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,160">160</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,161">161</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162">162</a></span><span class="line">    <span class="var type0" id="S82T0U584">seg_big</span> = imdilate(bwareaopen(<span class="var type0" id="S81T0U589">seg_open</span>,30),strel(<span class="string">'disk'</span>,1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,163">163</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,164">164</a></span><span class="line">    <span class="var type0" id="S85T0U597">distance</span> = -bwdist(~<span class="var type0" id="S82T0U602">seg_big</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,165">165</a></span><span class="line">    <span class="var type0" id="S85T0U606">distance</span>(~<span class="var type0" id="S82T0U608">seg_big</span>) = -Inf;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166">166</a></span><span class="line">    <span class="var type0" id="S88T0U614">distance2</span> = imhmin(<span class="var type0" id="S85T0U617">distance</span>, 1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,167">167</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,168">168</a></span><span class="line">    <span class="comment">%lines=ones(size(distance));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169">169</a></span><span class="line">    <span class="comment">%lines(watershed(distance2)==0)=0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171">171</a></span><span class="line">    clear <span class="string">distance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,172">172</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,173">173</a></span><span class="line">    <span class="var type0" id="S82T0U625">seg_big</span>(watershed(<span class="var type0" id="S88T0U629">distance2</span>)==0) = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174">174</a></span><span class="line">    <span class="var type0" id="S92T0U634">seg_nonoverlap</span> = <span class="var type0" id="S82T0U635">seg_big</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175">175</a></span><span class="line">    <span class="comment">%seg_nonoverlap = lines &amp; seg_big;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176">176</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,177">177</a></span><span class="line">    clear <span class="string">lines</span> <span class="string">distance2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178">178</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,179">179</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180">180</a></span><span class="line">    [<span class="var type2" id="S42T0U643">L</span>] = bwlabel(<span class="var type0" id="S92T0U646">seg_nonoverlap</span>, 4);</span></span>
<span class="srcline"><span class="lineno"><a href="1,181">181</a></span><span class="line">    <span class="var type0" id="S75T0U650">stats</span> = regionprops(<span class="var type2" id="S42T0U653">L</span>, <span class="string">'Area'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,182">182</a></span><span class="line">    <span class="var type0" id="S77T0U657">areas</span> = [<span class="var type0" id="S75T0U661">stats</span>.Area];</span></span>
<span class="srcline"><span class="lineno"><a href="1,183">183</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,184">184</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185">185</a></span><span class="line">    <span class="var type2" id="S54T0U665">ind</span> = find(<span class="var type0" id="S77T0U670">areas</span>&gt;20 &amp; <span class="var type0" id="S77T0U673">areas</span>&lt;1000);</span></span>
<span class="srcline"><span class="lineno"><a href="1,186">186</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,187">187</a></span><span class="line">    <span class="keyword">if</span> isempty(<span class="var type2" id="S54T0U679">ind</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,188">188</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189">189</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190">190</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,191">191</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192">192</a></span><span class="line">    <span class="var type0" id="S93T0U683">seg</span> = ismember(<span class="var type2" id="S42T0U686">L</span>,<span class="var type2" id="S54T0U687">ind</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,193">193</a></span><span class="line">    <span class="comment">%[L, num] = bwlabel(seg,8);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,194">194</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,195">195</a></span><span class="line">    <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196">196</a></span><span class="line">    [<span class="var type2" id="S42T0U691">L</span>,<span class="var type0" id="S94T0U692">num</span>] = bwlabel(imfill(<span class="var type0" id="S93T0U697">seg</span>, <span class="string">'holes'</span>),4);</span></span>
<span class="srcline"><span class="lineno"><a href="1,197">197</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,198">198</a></span><span class="line">    <span class="comment">% [Bounds] = bwboundaries(L&gt;0,4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199">199</a></span><span class="line">    <span class="comment">% Bounds = Bounds.';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200">200</a></span><span class="line">    <span class="comment">% figure;imshow(color_img,[]);impixelinfo; hold on;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201">201</a></span><span class="line">    <span class="comment">% for i=1:num</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,202">202</a></span><span class="line">    <span class="comment">%    bb=Bounds{i};</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,203">203</a></span><span class="line">    <span class="comment">%    plot(bb(:,2),bb(:,1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,204">204</a></span><span class="line">    <span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205">205</a></span><span class="line">    <span class="comment">% keyboard;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206">206</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,207">207</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,208">208</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,209">209</a></span><span class="line">    <span class="comment">% BW = L&gt;0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210">210</a></span><span class="line">    <span class="comment">% L = zeros(size(BW));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,211">211</a></span><span class="line">    <span class="comment">% boundaries = bwboundaries(BW);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212">212</a></span><span class="line">    <span class="comment">% num = length(boundaries);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,213">213</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214">214</a></span><span class="line">    <span class="comment">% count = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215">215</a></span><span class="line">    <span class="comment">% for i = 1:num</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216">216</a></span><span class="line">    <span class="comment">%     b = boundaries{i};</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217">217</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218">218</a></span><span class="line">    <span class="comment">%     if size(b,1) &gt; 15</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219">219</a></span><span class="line">    <span class="comment">%         b(:,2) = lowB(b(:,2));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220">220</a></span><span class="line">    <span class="comment">%         b(:,1) = lowB(b(:,1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221">221</a></span><span class="line">    <span class="comment">%         if any(b(:)&lt;0 | b(:)&gt;4096)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222">222</a></span><span class="line">    <span class="comment">%           continue;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,223">223</a></span><span class="line">    <span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,224">224</a></span><span class="line">    <span class="comment">%         boundaries{i} = b;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225">225</a></span><span class="line">    <span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226">226</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,227">227</a></span><span class="line">    <span class="comment">%     tempBW = roipoly(BW,b(:,2),b(:,1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,228">228</a></span><span class="line">    <span class="comment">%     if sum(tempBW(:)) == 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229">229</a></span><span class="line">    <span class="comment">%         continue;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230">230</a></span><span class="line">    <span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,231">231</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,232">232</a></span><span class="line">    <span class="comment">%     L(tempBW) = count;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,233">233</a></span><span class="line">    <span class="comment">%     count = count + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,234">234</a></span><span class="line">    <span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,235">235</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236">236</a></span><span class="line">    <span class="comment">% labels=unique(L(:));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,237">237</a></span><span class="line">    <span class="comment">% count=0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238">238</a></span><span class="line">    <span class="comment">% LL = zeros(size(BW));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239">239</a></span><span class="line">    <span class="comment">% for i = 1:length(labels)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,240">240</a></span><span class="line">    <span class="comment">%     LL(L==labels(i))=count;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241">241</a></span><span class="line">    <span class="comment">%     count=count+1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,242">242</a></span><span class="line">    <span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,243">243</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,244">244</a></span><span class="line">    <span class="comment">% L = LL;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,245">245</a></span><span class="line">    <span class="comment">% num = max(L(:));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,246">246</a></span><span class="line">    <span class="comment">% difflabels = setdiff(0:num,unique(L(:)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,247">247</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,248">248</a></span><span class="line">    <span class="comment">% if ~isempty(difflabels)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,249">249</a></span><span class="line">    <span class="comment">%     f=[];L=[];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,250">250</a></span><span class="line">    <span class="comment">%     return;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,251">251</a></span><span class="line">    <span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,252">252</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,253">253</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,254">254</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,255">255</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,256">256</a></span><span class="line">    <span class="var type0" id="S95T0U702">smallG</span> = double(<span class="var type2" id="S43T0U707">color_img</span>(:,:,2))./(double(sum(<span class="var type2" id="S43T0U717">color_img</span>, 3))+eps);</span></span>
<span class="srcline"><span class="lineno"><a href="1,257">257</a></span><span class="line">    [<span class="var type0" id="S97T0U724">Gx</span>, <span class="var type0" id="S98T0U725">Gy</span>] = gradient(<span class="var type0" id="S95T0U728">smallG</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,258">258</a></span><span class="line">    <span class="var type0" id="S100T0U731">diffG</span> = sqrt(<span class="var type0" id="S97T0U736">Gx</span>.*<span class="var type0" id="S97T0U737">Gx</span>+<span class="var type0" id="S98T0U739">Gy</span>.*<span class="var type0" id="S98T0U740">Gy</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,259">259</a></span><span class="line">    <span class="var type0" id="S102T0U743">BW_canny</span> = edge(<span class="var type0" id="S95T0U746">smallG</span>,<span class="string">'canny'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,260">260</a></span><span class="line">    <span class="var type0" id="S104T0U750">seSmall</span> = strel(<span class="string">'disk'</span>, 2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,261">261</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,262">262</a></span><span class="line">    <span class="var type0" id="S105T0U757">statsI</span> = regionprops( <span class="var type2" id="S42T0U760">L</span>, <span class="var type0" id="S95T0U761">smallG</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,263">263</a></span><span class="line">        <span class="string">'Area'</span>,<span class="string">'Perimeter'</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,264">264</a></span><span class="line">        <span class="string">'Eccentricity'</span>,<span class="string">'MajorAxisLength'</span>,<span class="string">'MinorAxisLength'</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,265">265</a></span><span class="line">        <span class="string">'Extent'</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,266">266</a></span><span class="line">        <span class="string">'MaxIntensity'</span>,<span class="string">'MeanIntensity'</span>,<span class="string">'MinIntensity'</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,267">267</a></span><span class="line">        <span class="string">'PixelIdxList'</span>);  <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,268">268</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,269">269</a></span><span class="line">    <span class="var type0" id="S106T0U774">fArea</span> = cat(1,<span class="var type0" id="S105T0U779">statsI</span>.Area);</span></span>
<span class="srcline"><span class="lineno"><a href="1,270">270</a></span><span class="line">    <span class="var type0" id="S108T0U783">fPerimeter</span> = cat(1,<span class="var type0" id="S105T0U788">statsI</span>.Perimeter);</span></span>
<span class="srcline"><span class="lineno"><a href="1,271">271</a></span><span class="line">    <span class="var type0" id="S109T0U792">fEccentricity</span> = cat(1,<span class="var type0" id="S105T0U797">statsI</span>.Eccentricity);</span></span>
<span class="srcline"><span class="lineno"><a href="1,272">272</a></span><span class="line">    <span class="var type0" id="S110T0U801">fCircularity</span> = 4*pi * <span class="var type0" id="S106T0U808">fArea</span>./ (<span class="var type0" id="S108T0U811">fPerimeter</span>.^2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,273">273</a></span><span class="line">    <span class="var type0" id="S112T0U815">fMajorAxisLength</span> = cat(1,<span class="var type0" id="S105T0U820">statsI</span>.MajorAxisLength);</span></span>
<span class="srcline"><span class="lineno"><a href="1,274">274</a></span><span class="line">    <span class="var type0" id="S113T0U824">fMinorAxisLength</span> = cat(1,<span class="var type0" id="S105T0U829">statsI</span>.MinorAxisLength);</span></span>
<span class="srcline"><span class="lineno"><a href="1,275">275</a></span><span class="line">    <span class="var type0" id="S114T0U833">fExtent</span> = cat(1,<span class="var type0" id="S105T0U838">statsI</span>.Extent);</span></span>
<span class="srcline"><span class="lineno"><a href="1,276">276</a></span><span class="line">    <span class="var type0" id="S115T0U842">fMeanIntensity</span> = cat(1,<span class="var type0" id="S105T0U847">statsI</span>.MeanIntensity);</span></span>
<span class="srcline"><span class="lineno"><a href="1,277">277</a></span><span class="line">    <span class="var type0" id="S116T0U851">fMaxIntensity</span> = cat(1,<span class="var type0" id="S105T0U856">statsI</span>.MaxIntensity);</span></span>
<span class="srcline"><span class="lineno"><a href="1,278">278</a></span><span class="line">    <span class="var type0" id="S117T0U860">fMinIntensity</span> = cat(1,<span class="var type0" id="S105T0U865">statsI</span>.MinIntensity);</span></span>
<span class="srcline"><span class="lineno"><a href="1,279">279</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,280">280</a></span><span class="line">    <span class="comment">%indices = regionprops(L, 'PixelIdxList'); %get indices of objects once</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,281">281</a></span><span class="line">    <span class="comment">%props = regionprops(L, diffG, 'PixelValues'); %call regionprops once</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,282">282</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,283">283</a></span><span class="line">    <span class="var type2" id="S41T0U869">f</span>=zeros(<span class="var type0" id="S94T0U872">num</span>,19);</span></span>
<span class="srcline"><span class="lineno"><a href="1,284">284</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,285">285</a></span><span class="line">    <span class="keyword">for</span> <span class="var type0" id="S118T0U876">i</span> = 1:<span class="var type0" id="S94T0U879">num</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286">286</a></span><span class="line">        <span class="comment">%single_bw = L==i;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,287">287</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,288">288</a></span><span class="line">        <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,289">289</a></span><span class="line">        <span class="var type0" id="S119T0U882">pixOfInterest</span> = <span class="var type0" id="S95T0U884">smallG</span>(<span class="var type0" id="S105T0U887">statsI</span>(<span class="var type0" id="S118T0U888">i</span>).PixelIdxList);</span></span>
<span class="srcline"><span class="lineno"><a href="1,290">290</a></span><span class="line">        <span class="comment">%pixOfInterest = smallG(indices(i).PixelIdxList);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291">291</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,292">292</a></span><span class="line">        <span class="var type0" id="S120T0U892">fStdIntensity</span> = std(<span class="var type0" id="S119T0U895">pixOfInterest</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,293">293</a></span><span class="line">        [<span class="var type0" id="S122T0U899">counts</span>,<span class="var type0" id="S123T0U900">binLocation</span>] = imhist(im2uint8(<span class="var type0" id="S119T0U905">pixOfInterest</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,294">294</a></span><span class="line">        <span class="var type0" id="S126T0U908">prob</span> = <span class="var type0" id="S122T0U910">counts</span>/sum(<span class="var type0" id="S122T0U913">counts</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,295">295</a></span><span class="line">        <span class="var type0" id="S127T0U916">fEntropy</span> = entropy(<span class="var type0" id="S126T0U919">prob</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,296">296</a></span><span class="line">        <span class="var type0" id="S129T0U922">fEnergy</span> = sum(<span class="var type0" id="S126T0U926">prob</span>.^2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,297">297</a></span><span class="line">        <span class="var type0" id="S130T0U930">fSkewness</span> = skewness( double(<span class="var type0" id="S119T0U935">pixOfInterest</span>) );</span></span>
<span class="srcline"><span class="lineno"><a href="1,298">298</a></span><span class="line">        <span class="var type0" id="S132T0U938">fKurtosis</span> = kurtosis( double(<span class="var type0" id="S119T0U943">pixOfInterest</span>) );</span></span>
<span class="srcline"><span class="lineno"><a href="1,299">299</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,300">300</a></span><span class="line">        <span class="comment">%eliminate FSD calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301">301</a></span><span class="line">        <span class="comment">%     ini = find( single_bw==1 );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302">302</a></span><span class="line">        <span class="comment">%     [ini_r ini_c] = ind2sub(size(single_bw),ini(1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303">303</a></span><span class="line">        <span class="comment">%     Pts = bwtraceboundary( single_bw, [ini_r ini_c], 'NE' );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304">304</a></span><span class="line">        <span class="comment">%     complexPts = Pts(:,1) + j*Pts(:,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305">305</a></span><span class="line">        <span class="comment">%     S = abs(fft(complexPts))/size(complexPts,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306">306</a></span><span class="line">        <span class="comment">%     fFSD = S(3:end)/S(2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307">307</a></span><span class="line">        <span class="var type0" id="S134T0U946">fFSD</span> = zeros(5, 1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,308">308</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,309">309</a></span><span class="line">        <span class="comment">%---part II---</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,310">310</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,311">311</a></span><span class="line">        <span class="comment">%    stats = regionprops( bwlabel(single_bw, 8), diffG,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,312">312</a></span><span class="line">        <span class="comment">%        'PixelValues');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313">313</a></span><span class="line">        <span class="comment">%    pixOfInterest = stats.PixelValues;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,314">314</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,315">315</a></span><span class="line">        <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,316">316</a></span><span class="line">        <span class="var type0" id="S119T0U953">pixOfInterest</span> = <span class="var type0" id="S100T0U955">diffG</span>(<span class="var type0" id="S105T0U958">statsI</span>(<span class="var type0" id="S118T0U959">i</span>).PixelIdxList);</span></span>
<span class="srcline"><span class="lineno"><a href="1,317">317</a></span><span class="line">        <span class="comment">%pixOfInterest = diffG(indices(i).PixelIdxList);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318">318</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,319">319</a></span><span class="line">        <span class="var type0" id="S135T0U963">fMeanGradMag</span> = mean(<span class="var type0" id="S119T0U966">pixOfInterest</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,320">320</a></span><span class="line">        <span class="var type0" id="S137T0U969">fStdGradMag</span> = std(<span class="var type0" id="S119T0U972">pixOfInterest</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,321">321</a></span><span class="line">        [<span class="var type0" id="S122T0U976">counts</span>,<span class="var type0" id="S123T0U977">binLocation</span>] = imhist(im2uint8(<span class="var type0" id="S119T0U982">pixOfInterest</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,322">322</a></span><span class="line">        <span class="var type0" id="S126T0U985">prob</span> = <span class="var type0" id="S122T0U987">counts</span>/sum(<span class="var type0" id="S122T0U990">counts</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,323">323</a></span><span class="line">        <span class="var type0" id="S138T0U993">fEntropyGradMag</span> = entropy(<span class="var type0" id="S126T0U996">prob</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,324">324</a></span><span class="line">        <span class="var type0" id="S139T0U999">fEnergyGradMag</span> = sum(<span class="var type0" id="S126T0U1003">prob</span>.^2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,325">325</a></span><span class="line">        <span class="var type0" id="S140T0U1007">fSkewnessGradMag</span> = skewness( double(<span class="var type0" id="S119T0U1012">pixOfInterest</span>) );</span></span>
<span class="srcline"><span class="lineno"><a href="1,326">326</a></span><span class="line">        <span class="var type0" id="S141T0U1015">fKurtosisGradMag</span> = kurtosis( double(<span class="var type0" id="S119T0U1020">pixOfInterest</span>) );</span></span>
<span class="srcline"><span class="lineno"><a href="1,327">327</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,328">328</a></span><span class="line">        <span class="comment">%---part III---</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,329">329</a></span><span class="line">        <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,330">330</a></span><span class="line">        <span class="var type0" id="S142T0U1023">bw_canny</span> = <span class="var type0" id="S102T0U1025">BW_canny</span>(<span class="var type0" id="S105T0U1028">statsI</span>(<span class="var type0" id="S118T0U1029">i</span>).PixelIdxList);</span></span>
<span class="srcline"><span class="lineno"><a href="1,331">331</a></span><span class="line">        <span class="comment">%bw_canny = BW_canny(indices(i).PixelIdxList);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,332">332</a></span><span class="line">        <span class="comment">%bw_canny = BW_canny(single_bw);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,333">333</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,334">334</a></span><span class="line">        <span class="var type0" id="S143T0U1033">fSumCanny</span> = sum(<span class="var type0" id="S142T0U1037">bw_canny</span>(:));</span></span>
<span class="srcline"><span class="lineno"><a href="1,335">335</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,336">336</a></span><span class="line">        <span class="comment">%CHANGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,337">337</a></span><span class="line">        <span class="var type0" id="S144T0U1041">fMeanCanny</span> = <span class="var type0" id="S143T0U1043">fSumCanny</span> / length(<span class="var type0" id="S105T0U1048">statsI</span>(<span class="var type0" id="S118T0U1049">i</span>).PixelIdxList);</span></span>
<span class="srcline"><span class="lineno"><a href="1,338">338</a></span><span class="line">        <span class="comment">%fMeanCanny = fSumCanny / length(indices(i).PixelIdxList);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,339">339</a></span><span class="line">        <span class="comment">%fMeanCanny = fSumCanny / sum(single_bw(:));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,340">340</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,341">341</a></span><span class="line">        <span class="comment">%---default grade----</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,342">342</a></span><span class="line">        <span class="var type0" id="S146T0U1053">fGrade</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,343">343</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,344">344</a></span><span class="line">        <span class="comment">%Aggregate features from part I, II, and III</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,345">345</a></span><span class="line">        <span class="keyword">if</span> length(<span class="var type0" id="S134T0U1060">fFSD</span>) &lt; 5</span></span>
<span class="srcline"><span class="lineno"><a href="1,346">346</a></span><span class="line">            <span class="var type0" id="S134T0U1064">fFSD</span> = [<span class="var type0" id="S134T0U1069">fFSD</span>(:)' zeros(1, 5-length(<span class="var type0" id="S134T0U1078">fFSD</span>))];</span></span>
<span class="srcline"><span class="lineno"><a href="1,347">347</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,348">348</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,349">349</a></span><span class="line">        <span class="var type0" id="S147T0U1081">featureVec</span> = [,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350">350</a></span><span class="line">            <span class="var type0" id="S134T0U1085">fFSD</span>(1), <span class="var type0" id="S134T0U1088">fFSD</span>(2), <span class="var type0" id="S134T0U1091">fFSD</span>(3), <span class="var type0" id="S134T0U1094">fFSD</span>(4), <span class="var type0" id="S134T0U1097">fFSD</span>(5),<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351">351</a></span><span class="line">            <span class="var type0" id="S120T0U1099">fStdIntensity</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,352">352</a></span><span class="line">            <span class="var type0" id="S127T0U1100">fEntropy</span>, <span class="var type0" id="S129T0U1101">fEnergy</span>, <span class="var type0" id="S130T0U1102">fSkewness</span>, <span class="var type0" id="S132T0U1103">fKurtosis</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,353">353</a></span><span class="line">            <span class="var type0" id="S135T0U1104">fMeanGradMag</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,354">354</a></span><span class="line">            <span class="var type0" id="S137T0U1105">fStdGradMag</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,355">355</a></span><span class="line">            <span class="var type0" id="S138T0U1106">fEntropyGradMag</span>,<span class="var type0" id="S139T0U1107">fEnergyGradMag</span>,<span class="var type0" id="S140T0U1108">fSkewnessGradMag</span>,<span class="var type0" id="S141T0U1109">fKurtosisGradMag</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,356">356</a></span><span class="line">            <span class="var type0" id="S143T0U1110">fSumCanny</span>,<span class="var type0" id="S144T0U1111">fMeanCanny</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,357">357</a></span><span class="line">            <span class="var type0" id="S146T0U1112">fGrade</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="1,358">358</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,359">359</a></span><span class="line">        <span class="var type2" id="S41T0U1116">f</span>(<span class="var type0" id="S118T0U1117">i</span>,:) = <span class="var type0" id="S147T0U1119">featureVec</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,360">360</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,361">361</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,362">362</a></span><span class="line">    <span class="var type0" id="S148T0U1122">old_f</span> = [<span class="var type0" id="S106T0U1125">fArea</span>, <span class="var type0" id="S108T0U1126">fPerimeter</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,363">363</a></span><span class="line">        <span class="var type0" id="S109T0U1127">fEccentricity</span>, <span class="var type0" id="S110T0U1128">fCircularity</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,364">364</a></span><span class="line">        <span class="var type2" id="S41T0U1130">f</span>(:,1:5),<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,365">365</a></span><span class="line">        <span class="var type0" id="S112T0U1135">fMajorAxisLength</span>, <span class="var type0" id="S113T0U1136">fMinorAxisLength</span>, <span class="var type0" id="S114T0U1137">fExtent</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366">366</a></span><span class="line">        <span class="var type0" id="S115T0U1138">fMeanIntensity</span>, <span class="var type0" id="S116T0U1139">fMaxIntensity</span>, <span class="var type0" id="S117T0U1140">fMinIntensity</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,367">367</a></span><span class="line">        <span class="var type2" id="S41T0U1142">f</span>(:,6:end)];</span></span>
<span class="srcline"><span class="lineno"><a href="1,368">368</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,369">369</a></span><span class="line">    <span class="var type0" id="S150T0U1150">delta</span> = 8;</span></span>
<span class="srcline"><span class="lineno"><a href="1,370">370</a></span><span class="line">    <span class="var type0" id="S151T0U1154">new_f</span> = CytoplasmFeatures(<span class="var type2" id="S42T0U1157">L</span>, <span class="var type2" id="S43T0U1158">color_img</span>, <span class="var type0" id="S95T0U1159">smallG</span>, <span class="var type0" id="S150T0U1160">delta</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,371">371</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,372">372</a></span><span class="line">    <span class="keyword">if</span> size(<span class="var type0" id="S148T0U1166">old_f</span>,1)~=size(<span class="var type0" id="S151T0U1170">new_f</span>,1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,373">373</a></span><span class="line">        fprintf(<span class="string">'No. of rows in the old feature set is not equal to that of the new feature set!\n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,374">374</a></span><span class="line">        <span class="var type0" id="S154T0U1178">Num_Row</span> = min(size(<span class="var type0" id="S148T0U1183">old_f</span>,1),size(<span class="var type0" id="S151T0U1187">new_f</span>,1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,375">375</a></span><span class="line">        <span class="var type2" id="S41T0U1191">f</span> = [<span class="var type0" id="S148T0U1195">old_f</span>(1:<span class="var type0" id="S154T0U1198">Num_Row</span>,:) <span class="var type0" id="S151T0U1201">new_f</span>(1:<span class="var type0" id="S154T0U1204">Num_Row</span>,:)];</span></span>
<span class="srcline"><span class="lineno"><a href="1,376">376</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,377">377</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,378">378</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,379">379</a></span><span class="line">    <span class="var type2" id="S41T0U1209">f</span> = [<span class="var type0" id="S148T0U1212">old_f</span> <span class="var type0" id="S151T0U1213">new_f</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="1,380">380</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,381">381</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,382">382</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,383">383</a></span><span class="line"></span></span>
</pre>
